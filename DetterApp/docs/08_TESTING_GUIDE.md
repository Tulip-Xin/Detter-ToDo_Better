# Detter App æµ‹è¯•æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº† Detter åº”ç”¨çš„æµ‹è¯•ç­–ç•¥å’Œæµ‹è¯•å¥—ä»¶ã€‚æˆ‘ä»¬å®ç°äº†å…¨é¢çš„æµ‹è¯•è¦†ç›–ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€ç»„ä»¶æµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ã€?

## æµ‹è¯•æ¡†æ¶

- **Jest**: JavaScript æµ‹è¯•æ¡†æ¶
- **React Native Testing Library**: React Native ç»„ä»¶æµ‹è¯•
- **@testing-library/react-hooks**: React Hooks æµ‹è¯•

## æµ‹è¯•ç»“æ„

```
DetterApp/
â”œâ”€â”€ __tests__/
â”?  â”œâ”€â”€ App.test.tsx                          # åº”ç”¨å…¥å£æµ‹è¯•
â”?  â”œâ”€â”€ integration/                          # é›†æˆæµ‹è¯•
â”?  â”?  â”œâ”€â”€ TaskCreationFlow.test.tsx        # ä»»åŠ¡åˆ›å»ºæµç¨‹
â”?  â”?  â”œâ”€â”€ TaskCompletionFlow.test.tsx      # ä»»åŠ¡å®Œæˆæµç¨‹
â”?  â”?  â””â”€â”€ DataImportExportFlow.test.tsx    # æ•°æ®å¯¼å…¥å¯¼å‡ºæµç¨‹
â”?  â””â”€â”€ performance/                          # æ€§èƒ½æµ‹è¯•
â”?      â”œâ”€â”€ PerformanceMonitor.test.tsx      # æ€§èƒ½ç›‘æ§
â”?      â”œâ”€â”€ ListPerformance.test.tsx         # åˆ—è¡¨æ€§èƒ½
â”?      â”œâ”€â”€ AnimationPerformance.test.tsx    # åŠ¨ç”»æ€§èƒ½
â”?      â””â”€â”€ StartupPerformance.test.tsx      # å¯åŠ¨æ€§èƒ½
â”œâ”€â”€ src/
â”?  â”œâ”€â”€ services/__tests__/                   # æœåŠ¡å±‚å•å…ƒæµ‹è¯?
â”?  â”?  â”œâ”€â”€ DatabaseService.test.ts
â”?  â”?  â”œâ”€â”€ TaskService.test.ts
â”?  â”?  â””â”€â”€ ReflectionService.test.ts
â”?  â”œâ”€â”€ utils/__tests__/                      # å·¥å…·å‡½æ•°å•å…ƒæµ‹è¯•
â”?  â”?  â”œâ”€â”€ dateUtils.test.ts
â”?  â”?  â””â”€â”€ filterUtils.test.ts
â”?  â”œâ”€â”€ contexts/__tests__/                   # Context æµ‹è¯•
â”?  â”?  â”œâ”€â”€ TaskContext.test.tsx
â”?  â”?  â””â”€â”€ ThemeContext.test.tsx
â”?  â””â”€â”€ components/                           # ç»„ä»¶æµ‹è¯•
â”?      â”œâ”€â”€ task/__tests__/
â”?      â”?  â”œâ”€â”€ TaskItem.test.tsx
â”?      â”?  â””â”€â”€ PriorityContainer.test.tsx
â”?      â”œâ”€â”€ common/__tests__/
â”?      â”?  â”œâ”€â”€ BottomSheet.test.tsx
â”?      â”?  â””â”€â”€ DateSelector.test.tsx
â”?      â””â”€â”€ reflection/__tests__/
â”?          â””â”€â”€ ChecklistView.test.tsx
```

## è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯?
```bash
npm test
```

### è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
```bash
npm test -- TaskService.test.ts
```

### è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
```bash
npm test -- --coverage
```

### è¿è¡Œç‰¹å®šç±»å‹çš„æµ‹è¯?
```bash
# å•å…ƒæµ‹è¯•
npm test -- --testPathPattern="services/__tests__|utils/__tests__"

# ç»„ä»¶æµ‹è¯•
npm test -- --testPathPattern="components/__tests__"

# é›†æˆæµ‹è¯•
npm test -- --testPathPattern="integration"

# æ€§èƒ½æµ‹è¯•
npm test -- --testPathPattern="performance"
```

### ç›‘å¬æ¨¡å¼
```bash
npm test -- --watch
```

## æµ‹è¯•è¦†ç›–ç‡ç›®æ ?

- **æ ¸å¿ƒä¸šåŠ¡é€»è¾‘**: 90%+
- **UI ç»„ä»¶**: 70%+
- **å·¥å…·å‡½æ•°**: 95%+

## å•å…ƒæµ‹è¯•

### DatabaseService æµ‹è¯•
æµ‹è¯•æ•°æ®åº“åˆå§‹åŒ–ã€äº‹åŠ¡å¤„ç†ã€SQL æ‰§è¡Œç­‰æ ¸å¿ƒåŠŸèƒ½ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- æ•°æ®åº“åˆå§‹åŒ–
- è¡¨å’Œç´¢å¼•åˆ›å»º
- äº‹åŠ¡æ‰§è¡Œ
- SQL æŸ¥è¯¢
- é”™è¯¯å¤„ç†

### TaskService æµ‹è¯•
æµ‹è¯•ä»»åŠ¡çš?CRUD æ“ä½œå’Œä¸šåŠ¡é€»è¾‘ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- åˆ›å»ºä»»åŠ¡
- æŒ‰æ—¥æœŸæŸ¥è¯¢ä»»åŠ?
- æ›´æ–°ä»»åŠ¡
- åˆ é™¤ä»»åŠ¡
- è·å–å·²å®Œæˆä»»åŠ?
- ä»»åŠ¡æ’åº

### ReflectionService æµ‹è¯•
æµ‹è¯•å¤ç›˜ç¬”è®°çš„ç®¡ç†åŠŸèƒ½ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- åˆ›å»ºå¤ç›˜ç¬”è®°
- æŸ¥è¯¢å¤ç›˜ç¬”è®°
- æ›´æ–°å¤ç›˜ç¬”è®°
- åˆ é™¤å¤ç›˜ç¬”è®°
- ä¿å­˜æˆ–æ›´æ–°å¤ç›?

### å·¥å…·å‡½æ•°æµ‹è¯•
æµ‹è¯•æ—¥æœŸå¤„ç†ã€ç­›é€‰ç­‰å·¥å…·å‡½æ•°ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- æ—¥æœŸæ ¼å¼åŒ?
- æ—¥æœŸæ¯”è¾ƒ
- ä»»åŠ¡ç­›é€?
- å…³é”®è¯æœç´?

## ç»„ä»¶æµ‹è¯•

### TaskItem æµ‹è¯•
æµ‹è¯•ä»»åŠ¡é¡¹çš„æ¸²æŸ“å’Œäº¤äº’ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- æ¸²æŸ“ä»»åŠ¡ä¿¡æ¯
- å¤é€‰æ¡†ç‚¹å‡»
- ä»»åŠ¡ç‚¹å‡»
- å®ŒæˆçŠ¶æ€æ˜¾ç¤?
- æ ‡ç­¾æ˜¾ç¤º

### PriorityContainer æµ‹è¯•
æµ‹è¯•ä¼˜å…ˆçº§å®¹å™¨çš„åŠŸèƒ½ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- æ¸²æŸ“ä¼˜å…ˆçº§æ ‡é¢?
- æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨
- ç©ºçŠ¶æ€å ä½ç¬¦
- æ·»åŠ ä»»åŠ¡è§¦å‘

### BottomSheet æµ‹è¯•
æµ‹è¯•åº•éƒ¨å¼¹å‡ºé¢æ¿ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- æ˜¾ç¤º/éšè—
- èƒŒæ™¯ç‚¹å‡»å…³é—­
- å†…å®¹æ¸²æŸ“
- è‡ªå®šä¹?snap points

### ChecklistView æµ‹è¯•
æµ‹è¯•æ¸…å•åˆ—è¡¨è§†å›¾ã€?

**å…³é”®æµ‹è¯•ç”¨ä¾‹:**
- ä»»åŠ¡åˆ—è¡¨æ¸²æŸ“
- ä»»åŠ¡ç‚¹å‡»
- å¤ç›˜çŠ¶æ€é«˜äº?
- ç©ºçŠ¶æ€æ˜¾ç¤?

## é›†æˆæµ‹è¯•

### ä»»åŠ¡åˆ›å»ºæµç¨‹æµ‹è¯•
æµ‹è¯•ä»æ‰“å¼€æ·»åŠ é¢æ¿åˆ°ä¿å­˜ä»»åŠ¡çš„å®Œæ•´æµç¨‹ã€?

**æµ‹è¯•åœºæ™¯:**
- å®Œæ•´ä»»åŠ¡åˆ›å»ºæµç¨‹
- å¸¦å­ä»»åŠ¡çš„ä»»åŠ¡åˆ›å»?
- å¿…å¡«å­—æ®µéªŒè¯
- ä»ç©ºå®¹å™¨æ·»åŠ ä»»åŠ¡

### ä»»åŠ¡å®Œæˆå’Œå¤ç›˜æµç¨‹æµ‹è¯?
æµ‹è¯•ä»»åŠ¡å®Œæˆå’Œå¤ç›˜çš„å®Œæ•´æµç¨‹ã€?

**æµ‹è¯•åœºæ™¯:**
- å®Œæˆä»»åŠ¡å¹¶æ·»åŠ å¤ç›?
- å®Œæˆä»»åŠ¡ä¸æ·»åŠ å¤ç›?
- å¸¦å­ä»»åŠ¡çš„ä»»åŠ¡å®Œæˆ?
- å®ŒæˆåŠ¨ç”»

### æ•°æ®å¯¼å…¥å¯¼å‡ºæµç¨‹æµ‹è¯•
æµ‹è¯•æ•°æ®çš„å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ã€?

**æµ‹è¯•åœºæ™¯:**
- JSON æ ¼å¼å¯¼å‡º
- CSV æ ¼å¼å¯¼å‡º
- JSON æ ¼å¼å¯¼å…¥
- æ•°æ®æ ¼å¼éªŒè¯
- å¯¼å…¥å†²çªå¤„ç†
- æ•°æ®æ¸…ç©º

## æ€§èƒ½æµ‹è¯•

### å¯åŠ¨æ€§èƒ½æµ‹è¯•
æµ‹è¯•åº”ç”¨å¯åŠ¨æ—¶é—´ã€?

**æ€§èƒ½æŒ‡æ ‡:**
- å†·å¯åŠ¨æ—¶é—?< 2ç§?
- æ•°æ®åº“åˆå§‹åŒ– < 500ms
- æ•°æ®åŠ è½½ < 1ç§?

### åˆ—è¡¨æ€§èƒ½æµ‹è¯•
æµ‹è¯•å¤§æ•°æ®é‡ä¸‹çš„åˆ—è¡¨æ€§èƒ½ã€?

**æ€§èƒ½æŒ‡æ ‡:**
- 100 ä¸ªä»»åŠ¡æ¸²æŸ?< 1ç§?
- 200 ä¸ªä»»åŠ¡æ¸…å•æ¸²æŸ?< 1.5ç§?
- åˆ—è¡¨æ›´æ–° < 500ms
- æ»šåŠ¨æµç•…åº?60fps

### åŠ¨ç”»æ€§èƒ½æµ‹è¯•
æµ‹è¯•åŠ¨ç”»çš„æµç•…åº¦ã€?

**æ€§èƒ½æŒ‡æ ‡:**
- ä»»åŠ¡å®ŒæˆåŠ¨ç”» < 500ms
- å¡ç‰‡åˆ—è¡¨æ¸²æŸ“ < 1ç§?
- æ»šåŠ¨åŠ¨ç”» 60fps
- Snap-to-center åŠ¨ç”» < 100ms

### æ€§èƒ½ç›‘æ§æµ‹è¯•
æµ‹è¯•æ€§èƒ½ç›‘æ§å·¥å…·çš„å‡†ç¡®æ€§ã€?

**æµ‹è¯•å†…å®¹:**
- å‡½æ•°æ‰§è¡Œæ—¶é—´æµ‹é‡
- æ€§èƒ½ç“¶é¢ˆè¯†åˆ«
- å¹³å‡æ€§èƒ½è®¡ç®—
- å†…å­˜ä½¿ç”¨æ¨¡å¼

## Mock é…ç½®

### å·?Mock çš„æ¨¡å?
- `react-native-sqlite-storage`: æ•°æ®åº?
- `react-native-reanimated`: åŠ¨ç”»
- `react-native-gesture-handler`: æ‰‹åŠ¿
- `@gorhom/bottom-sheet`: åº•éƒ¨é¢æ¿
- `@react-native-async-storage/async-storage`: å­˜å‚¨
- `react-native-fs`: æ–‡ä»¶ç³»ç»Ÿ
- `@notifee/react-native`: é€šçŸ¥
- `react-native-splash-screen`: å¯åŠ¨å±?

## æœ€ä½³å®è·?

### 1. æµ‹è¯•éš”ç¦»
æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„çŠ¶æ€ã€?

```typescript
beforeEach(() => {
  jest.clearAllMocks();
});
```

### 2. ä½¿ç”¨æœ‰æ„ä¹‰çš„æµ‹è¯•æè¿°
```typescript
it('should create a new task with title and priority', async () => {
  // ...
});
```

### 3. æµ‹è¯•è¾¹ç•Œæƒ…å†µ
- ç©ºæ•°æ?
- æ— æ•ˆè¾“å…¥
- é”™è¯¯å¤„ç†
- æé™å€?

### 4. é¿å…æµ‹è¯•å®ç°ç»†èŠ‚
æµ‹è¯•åº”è¯¥å…³æ³¨è¡Œä¸ºè€Œä¸æ˜¯å®ç°ã€?

### 5. ä½¿ç”¨ waitFor å¤„ç†å¼‚æ­¥æ“ä½œ
```typescript
await waitFor(() => {
  expect(getByText('ä»»åŠ¡å·²åˆ›å»?)).toBeTruthy();
});
```

### 6. æ€§èƒ½æµ‹è¯•è®°å½•
åœ¨æ€§èƒ½æµ‹è¯•ä¸­è®°å½•å®é™…æ‰§è¡Œæ—¶é—´ï¼Œä¾¿äºè¿½è¸ªæ€§èƒ½å˜åŒ–ã€?

```typescript
console.log(`Execution time: ${duration}ms`);
```

## æŒç»­é›†æˆ

å»ºè®®åœ?CI/CD æµç¨‹ä¸­è¿è¡Œæµ‹è¯•ï¼š

```yaml
# .github/workflows/test.yml
name: Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
      - run: npm install
      - run: npm test -- --coverage
```

## æ•…éšœæ’æŸ¥

### æµ‹è¯•å¤±è´¥
1. æ£€æŸ?mock é…ç½®æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤å¼‚æ­¥æ“ä½œä½¿ç”¨äº?waitFor
3. éªŒè¯æµ‹è¯•æ•°æ®çš„æœ‰æ•ˆæ€?

### æ€§èƒ½æµ‹è¯•ä¸ç¨³å®?
1. å¢åŠ è¶…æ—¶æ—¶é—´
2. è¿è¡Œå¤šæ¬¡å–å¹³å‡å€?
3. è€ƒè™‘ç¯å¢ƒå› ç´ ï¼ˆCPUã€å†…å­˜ï¼‰

### Mock ä¸ç”Ÿæ•?
1. ç¡®è®¤ mock åœ¨å¯¼å…¥ä¹‹å‰?
2. æ£€æŸ?jest.config.js é…ç½®
3. æ¸…é™¤ Jest ç¼“å­˜: `npm test -- --clearCache`

## æœªæ¥æ”¹è¿›

- [ ] æ·»åŠ  E2E æµ‹è¯•ï¼ˆä½¿ç”?Detoxï¼?
- [ ] å¢åŠ è§†è§‰å›å½’æµ‹è¯•
- [ ] å®ç°è‡ªåŠ¨åŒ–æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] æ·»åŠ æ›´å¤šè¾¹ç•Œæƒ…å†µæµ‹è¯•
- [ ] æé«˜æµ‹è¯•è¦†ç›–ç‡åˆ° 90%+

## å‚è€ƒèµ„æº?

- [Jest æ–‡æ¡£](https://jestjs.io/)
- [React Native Testing Library](https://callstack.github.io/react-native-testing-library/)
- [Testing Best Practices](https://kentcdodds.com/blog/common-mistakes-with-react-testing-library)
