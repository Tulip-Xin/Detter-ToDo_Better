# Detter å¼€å‘è€…æ–‡æ¡£

æœ¬æ–‡æ¡£é¢å‘å¼€å‘è€…ï¼Œæä¾›é¡¹ç›®æ¶æ„ã€å¼€å‘æµç¨‹ã€æ„å»ºéƒ¨ç½²ç­‰è¯¦ç»†ä¿¡æ¯ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [å¼€å‘ç¯å¢ƒæ­å»º](#å¼€å‘ç¯å¢ƒæ­å»º)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [æ ¸å¿ƒæ¨¡å—è¯´æ˜](#æ ¸å¿ƒæ¨¡å—è¯´æ˜)
- [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
- [æ„å»ºå’Œéƒ¨ç½²](#æ„å»ºå’Œéƒ¨ç½²)
- [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## é¡¹ç›®æ¦‚è¿°

### æŠ€æœ¯æ ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        React Native 0.72+              â”‚
â”‚        TypeScript 4.9+                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UI Layer                               â”‚
â”‚ - React Navigation 6.x                 â”‚
â”‚ - React Native Reanimated 3.x          â”‚
â”‚ - React Native Gesture Handler 2.x     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ State Management                       â”‚
â”‚ - React Context API                    â”‚
â”‚ - useReducer                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Data Layer                             â”‚
â”‚ - SQLite (react-native-sqlite-storage) â”‚
â”‚ - Repository Pattern                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Platform                               â”‚
â”‚ - Android 9.0+ (API 28+)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| react-native | 0.72+ | æ ¸å¿ƒæ¡†æ¶ |
| typescript | 4.9+ | ç±»å‹ç³»ç»Ÿ |
| @react-navigation/native | 6.x | å¯¼èˆªç®¡ç† |
| react-native-reanimated | 3.x | é«˜æ€§èƒ½åŠ¨ç”» |
| react-native-gesture-handler | 2.x | æ‰‹åŠ¿å¤„ç† |
| react-native-sqlite-storage | 6.x | æœ¬åœ°æ•°æ®åº“ |
| @gorhom/bottom-sheet | 4.x | åº•éƒ¨é¢æ¿ |
| date-fns | 2.x | æ—¥æœŸå¤„ç† |
| react-native-chart-kit | 6.x | å›¾è¡¨å±•ç¤º |
| @notifee/react-native | 7.x | æœ¬åœ°é€šçŸ¥ |

---

## æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Presentation Layer (UI Components)          â”‚
â”‚ - Screens (TaskScreen, ReflectionScreen)    â”‚
â”‚ - Components (TaskItem, CardListView)       â”‚
â”‚ - Navigation (BottomTabNavigator)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Business Logic Layer                        â”‚
â”‚ - Contexts (TaskContext, ThemeContext)      â”‚
â”‚ - Hooks (useTasks, useDatabase)             â”‚
â”‚ - Utils (dateUtils, filterUtils)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Data Access Layer                           â”‚
â”‚ - Services (TaskService, ReflectionService) â”‚
â”‚ - Repository Pattern                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Storage Layer                               â”‚
â”‚ - DatabaseService (SQLite)                  â”‚
â”‚ - Local Storage                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
User Action
    â†“
Component Event Handler
    â†“
Context Action Dispatcher
    â†“
Service Layer (Business Logic)
    â†“
DatabaseService (Data Persistence)
    ï¿½?
SQLite Database
    ï¿½?
Service Layer (Data Retrieval)
    ï¿½?
Context State Update
    ï¿½?
Component Re-render
```

### çŠ¶æ€ç®¡ï¿½?

ä½¿ç”¨ React Context API + useReducer æ¨¡å¼ï¿½?

```typescript
// TaskContext ç¤ºä¾‹
interface TaskState {
  tasks: Task[];
  selectedDate: Date;
  loading: boolean;
  error: string | null;
}

type TaskAction =
  | { type: 'SET_TASKS'; payload: Task[] }
  | { type: 'ADD_TASK'; payload: Task }
  | { type: 'UPDATE_TASK'; payload: Task }
  | { type: 'DELETE_TASK'; payload: string };

const taskReducer = (state: TaskState, action: TaskAction): TaskState => {
  // Reducer logic
};
```

---

## å¼€å‘ç¯å¢ƒæ­ï¿½?

### ç³»ç»Ÿè¦æ±‚

**Windows å¼€å‘ç¯ï¿½?*:
- Windows 10/11 (64-bit)
- Node.js 16+ (æ¨è 18 LTS)
- JDK 11 ï¿½?17
- Android Studio Arctic Fox æˆ–æ›´é«˜ç‰ˆï¿½?
- Android SDK (API 28-33)

**å¿…éœ€çš„ç¯å¢ƒå˜ï¿½?*:
```cmd
ANDROID_HOME=C:\Users\YourName\AppData\Local\Android\Sdk
JAVA_HOME=C:\Program Files\Java\jdk-17
```

### å¿«é€Ÿå¼€ï¿½?

```cmd
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/detter.git
cd detter/DetterApp

# 2. å®‰è£…ä¾èµ–
npm install

# 3. æ£€æŸ¥ç¯ï¿½?
preview-tools\check-environment.bat

# 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm start

# 5. è¿è¡Œ Android (æ–°ç»ˆï¿½?
npm run android
```

### è¯¦ç»†é…ç½®æ­¥éª¤

å‚è€ƒä»¥ä¸‹æ–‡æ¡£ï¼š
- [å¼€å‘ç¯å¢ƒé…ç½®](SETUP.md) - è¯¦ç»†çš„ç¯å¢ƒæ­å»ºæ­¥ï¿½?
- [Windows é¢„è§ˆæŒ‡å—](../preview-tools/WINDOWS_PREVIEW_GUIDE.md) - Windows ç‰¹å®šé…ç½®

---

## é¡¹ç›®ç»“æ„

### ç›®å½•ç»„ç»‡

```
DetterApp/
â”œâ”€â”€ android/                    # Android åŸç”Ÿä»£ç 
ï¿½?  â”œâ”€â”€ app/
ï¿½?  ï¿½?  â”œâ”€â”€ src/main/
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ AndroidManifest.xml
ï¿½?  ï¿½?  ï¿½?  â””â”€â”€ res/          # èµ„æºæ–‡ä»¶
ï¿½?  ï¿½?  â”œâ”€â”€ build.gradle      # åº”ç”¨çº§æ„å»ºé…ï¿½?
ï¿½?  ï¿½?  â””â”€â”€ proguard-rules.pro
ï¿½?  â”œâ”€â”€ gradle/               # Gradle é…ç½®
ï¿½?  â””â”€â”€ build.gradle          # é¡¹ç›®çº§æ„å»ºé…ï¿½?
ï¿½?
â”œâ”€â”€ src/                       # æºä»£ï¿½?
ï¿½?  â”œâ”€â”€ components/           # UI ç»„ä»¶
ï¿½?  ï¿½?  â”œâ”€â”€ common/          # é€šç”¨ç»„ä»¶
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ BottomSheet.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ DateSelector.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ Calendar.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ SearchBar.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ FilterPanel.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ TagInput.tsx
ï¿½?  ï¿½?  ï¿½?  â””â”€â”€ TimePicker.tsx
ï¿½?  ï¿½?  â”œâ”€â”€ task/            # ä»»åŠ¡ç›¸å…³ç»„ä»¶
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ TaskItem.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ PriorityContainer.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ TaskBoard.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ TaskAddPanel.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ TaskEditPanel.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ SubTaskList.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ SwipeableTaskItem.tsx
ï¿½?  ï¿½?  ï¿½?  â””â”€â”€ DraggableTaskList.tsx
ï¿½?  ï¿½?  â”œâ”€â”€ reflection/      # å¤ç›˜ç›¸å…³ç»„ä»¶
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ CardListView.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ ChecklistView.tsx
ï¿½?  ï¿½?  ï¿½?  â”œâ”€â”€ ReflectionCard.tsx
ï¿½?  ï¿½?  ï¿½?  â””â”€â”€ ReflectionInputPanel.tsx
ï¿½?  ï¿½?  â””â”€â”€ profile/         # ä¸ªäººä¸­å¿ƒç»„ä»¶
ï¿½?  ï¿½?      â”œâ”€â”€ CompletionRateChart.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ TaskDistributionChart.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ ReflectionStatsCard.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ ThemeSettings.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ NotificationSettings.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ DataExport.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ DataImport.tsx
ï¿½?  ï¿½?      â”œâ”€â”€ DataClear.tsx
ï¿½?  ï¿½?      â””â”€â”€ AboutAndHelp.tsx
ï¿½?  ï¿½?
ï¿½?  â”œâ”€â”€ screens/              # é¡µé¢ç»„ä»¶
ï¿½?  ï¿½?  â”œâ”€â”€ TaskScreen.tsx
ï¿½?  ï¿½?  â”œâ”€â”€ ReflectionScreen.tsx
ï¿½?  ï¿½?  â”œâ”€â”€ ProfileScreen.tsx
ï¿½?  ï¿½?  â”œâ”€â”€ TaskEditScreen.tsx
ï¿½?  ï¿½?  â””â”€â”€ ReflectionDetailScreen.tsx
ï¿½?  ï¿½?
ï¿½?  â”œâ”€â”€ navigation/           # å¯¼èˆªé…ç½®
ï¿½?  ï¿½?  â””â”€â”€ BottomTabNavigator.tsx
ï¿½?  ï¿½?
ï¿½?  â”œâ”€â”€ contexts/             # çŠ¶æ€ç®¡ï¿½?
ï¿½?  ï¿½?  â”œâ”€â”€ TaskContext.tsx
ï¿½?  ï¿½?  â””â”€â”€ ThemeContext.tsx
ï¿½?  ï¿½?
ï¿½?  â”œâ”€â”€ services/             # ä¸šåŠ¡é€»è¾‘æœåŠ¡
ï¿½?  ï¿½?  â”œâ”€â”€ DatabaseService.ts
ï¿½?  ï¿½?  â”œâ”€â”€ TaskService.ts
ï¿½?  ï¿½?  â”œâ”€â”€ ReflectionService.ts
ï¿½?  ï¿½?  â”œâ”€â”€ StatisticsService.ts
ï¿½?  ï¿½?  â””â”€â”€ NotificationService.ts
ï¿½?  ï¿½?
ï¿½?  â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
ï¿½?  ï¿½?  â”œâ”€â”€ types.ts
ï¿½?  ï¿½?  â””â”€â”€ index.ts
ï¿½?  ï¿½?
ï¿½?  â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
ï¿½?  ï¿½?  â”œâ”€â”€ constants.ts
ï¿½?  ï¿½?  â”œâ”€â”€ dateUtils.ts
ï¿½?  ï¿½?  â”œâ”€â”€ filterUtils.ts
ï¿½?  ï¿½?  â””â”€â”€ theme.ts
ï¿½?  ï¿½?
ï¿½?  â””â”€â”€ hooks/                # è‡ªå®šï¿½?Hooks
ï¿½?      â””â”€â”€ (å¾…å®ï¿½?
ï¿½?
â”œâ”€â”€ __tests__/                # æµ‹è¯•æ–‡ä»¶
ï¿½?  â”œâ”€â”€ unit/                # å•å…ƒæµ‹è¯•
ï¿½?  â”œâ”€â”€ integration/         # é›†æˆæµ‹è¯•
ï¿½?  â””â”€â”€ performance/         # æ€§èƒ½æµ‹è¯•
ï¿½?
â”œâ”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
ï¿½?  â”œâ”€â”€ completions/         # ä»»åŠ¡å®Œæˆæ–‡æ¡£
ï¿½?  â”œâ”€â”€ USER_GUIDE.md        # ç”¨æˆ·æŒ‡å—
ï¿½?  â”œâ”€â”€ DEVELOPER_GUIDE.md   # å¼€å‘è€…æŒ‡ï¿½?
ï¿½?  â”œâ”€â”€ KNOWN_ISSUES.md      # å·²çŸ¥é—®é¢˜
ï¿½?  â””â”€â”€ ...
ï¿½?
â”œâ”€â”€ preview-tools/            # é¢„è§ˆå·¥å…·
ï¿½?  â”œâ”€â”€ start-dev.bat        # å¯åŠ¨è„šæœ¬
ï¿½?  â”œâ”€â”€ check-environment.bat
ï¿½?  â””â”€â”€ ...
ï¿½?
â”œâ”€â”€ App.tsx                   # åº”ç”¨å…¥å£
â”œâ”€â”€ index.js                  # React Native å…¥å£
â”œâ”€â”€ package.json              # ä¾èµ–é…ç½®
â”œâ”€â”€ tsconfig.json             # TypeScript é…ç½®
â”œâ”€â”€ babel.config.js           # Babel é…ç½®
â”œâ”€â”€ jest.config.js            # Jest é…ç½®
â””â”€â”€ .eslintrc.js              # ESLint é…ç½®
```

### æ–‡ä»¶å‘½åè§„èŒƒ

- **ç»„ä»¶æ–‡ä»¶**: PascalCase (ä¾‹å¦‚: `TaskItem.tsx`)
- **å·¥å…·æ–‡ä»¶**: camelCase (ä¾‹å¦‚: `dateUtils.ts`)
- **å¸¸é‡æ–‡ä»¶**: camelCase (ä¾‹å¦‚: `constants.ts`)
- **æµ‹è¯•æ–‡ä»¶**: `*.test.ts` ï¿½?`*.test.tsx`
- **ç±»å‹æ–‡ä»¶**: `types.ts` ï¿½?`*.types.ts`

---

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. æ•°æ®ï¿½?(Services)

#### DatabaseService

è´Ÿè´£ SQLite æ•°æ®åº“çš„åˆå§‹åŒ–å’Œç®¡ç†ï¿½?

```typescript
class DatabaseService {
  private db: SQLite.SQLiteDatabase | null = null;
  
  async init(): Promise<void>;
  async createTables(): Promise<void>;
  async transaction(callback: Function): Promise<void>;
  async executeSql(sql: string, params?: any[]): Promise<any>;
}
```

**å…³é”®åŠŸèƒ½**:
- æ•°æ®åº“åˆå§‹åŒ–
- è¡¨ç»“æ„åˆ›ï¿½?
- äº‹åŠ¡ç®¡ç†
- SQL æ‰§è¡Œ

#### TaskService

ä»»åŠ¡ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¿½?

```typescript
class TaskService {
  async createTask(task: Omit<Task, 'id'>): Promise<Task>;
  async getTasksByDate(date: Date): Promise<Task[]>;
  async updateTask(task: Task): Promise<void>;
  async deleteTask(taskId: string): Promise<void>;
  async getCompletedTasks(): Promise<Task[]>;
  async updateTaskOrders(updates: Array<{id: string; order: number}>): Promise<void>;
}
```

**æ•°æ®åº“è¡¨ç»“æ„**:
```sql
CREATE TABLE tasks (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  description TEXT,
  priority TEXT NOT NULL,
  tags TEXT,
  subtasks TEXT,
  due_date INTEGER NOT NULL,
  reminder_time INTEGER,
  completed INTEGER DEFAULT 0,
  completed_at INTEGER,
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL,
  task_order INTEGER NOT NULL,
  archived INTEGER DEFAULT 0
);
```

#### ReflectionService

å¤ç›˜ç¬”è®°ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¿½?

```typescript
class ReflectionService {
  async createReflection(reflection: Omit<Reflection, 'id'>): Promise<Reflection>;
  async getReflectionByTaskId(taskId: string): Promise<Reflection | null>;
  async updateReflection(reflection: Reflection): Promise<void>;
  async deleteReflection(reflectionId: string): Promise<void>;
}
```

### 2. çŠ¶æ€ç®¡ï¿½?(Contexts)

#### TaskContext

ç®¡ç†ä»»åŠ¡ç›¸å…³çš„å…¨å±€çŠ¶æ€ï¿½?

```typescript
interface TaskContextValue {
  state: TaskState;
  loadTasks: (date: Date) => Promise<void>;
  addTask: (task: Omit<Task, 'id'>) => Promise<void>;
  updateTask: (task: Task) => Promise<void>;
  deleteTask: (taskId: string) => Promise<void>;
  setSelectedDate: (date: Date) => void;
}
```

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
const { state, loadTasks, addTask } = useContext(TaskContext);

useEffect(() => {
  loadTasks(new Date());
}, []);
```

#### ThemeContext

ç®¡ç†ä¸»é¢˜ç›¸å…³çš„å…¨å±€çŠ¶æ€ï¿½?

```typescript
interface ThemeContextValue {
  theme: Theme;
  themeMode: 'light' | 'dark' | 'system';
  setThemeMode: (mode: 'light' | 'dark' | 'system') => void;
}
```

### 3. UI ç»„ä»¶

#### é€šç”¨ç»„ä»¶ (common/)

**BottomSheet**: åº•éƒ¨å¼¹å‡ºé¢æ¿
- ä½¿ç”¨ `@gorhom/bottom-sheet`
- æ”¯æŒå¤šä¸ª snap points
- è‡ªåŠ¨é”®ç›˜å¤„ç†

**DateSelector**: æ—¥æœŸé€‰æ‹©ï¿½?
- æ¨ªå‘æ»šåŠ¨
- é¢„åŠ è½½å‰åæ•°ï¿½?
- é«˜äº®å½“å‰æ—¥æœŸ

**Calendar**: æ—¥å†ç»„ä»¶
- å…¬å† + å†œå†æ˜¾ç¤º
- æœˆä»½åˆ‡æ¢
- æ—¥æœŸé€‰æ‹©

#### ä»»åŠ¡ç»„ä»¶ (task/)

**TaskItem**: ä»»åŠ¡ï¿½?
- å¤é€‰æ¡†
- æ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾æ˜¾ï¿½?
- å®ŒæˆçŠ¶æ€åŠ¨ï¿½?

**PriorityContainer**: ä¼˜å…ˆçº§å®¹ï¿½?
- ä¸‰ä¸ªä¼˜å…ˆçº§åˆ†ï¿½?
- ç©ºçŠ¶æ€å ä½ç¬¦
- æ‹–æ‹½æ’åºæ”¯æŒ

**TaskBoard**: ä»»åŠ¡çœ‹æ¿
- ç»„åˆä¸‰ä¸ªä¼˜å…ˆçº§å®¹ï¿½?
- ä¸‹æ‹‰åˆ·æ–°
- æ—¥æœŸåˆ‡æ¢

#### å¤ç›˜ç»„ä»¶ (reflection/)

**CardListView**: å¡ç‰‡åˆ—è¡¨è§†å›¾
- åŠ¨æ€ç¼©æ”¾æ•ˆï¿½?
- è‡ªåŠ¨å±…ä¸­å¯¹é½
- æƒ¯æ€§æ»šåŠ¨æ§ï¿½?

**ChecklistView**: æ¸…å•åˆ—è¡¨è§†å›¾
- ç®€æ´åˆ—è¡¨å±•ï¿½?
- å¤ç›˜çŠ¶æ€æ ‡ï¿½?
- æ—¥æœŸæ’åº

---

## å¼€å‘è§„ï¿½?

### TypeScript è§„èŒƒ

```typescript
// ï¿½?å¥½çš„å®è·µ
interface Task {
  id: string;
  title: string;
  completed: boolean;
}

const createTask = (data: Omit<Task, 'id'>): Task => {
  return {
    id: uuid.v4(),
    ...data,
  };
};

// ï¿½?é¿å…
const createTask = (data: any): any => {
  // ...
};
```

### ç»„ä»¶è§„èŒƒ

```typescript
// ï¿½?å‡½æ•°ç»„ä»¶ + TypeScript
interface TaskItemProps {
  task: Task;
  onPress: (taskId: string) => void;
}

const TaskItem: React.FC<TaskItemProps> = ({ task, onPress }) => {
  const handlePress = useCallback(() => {
    onPress(task.id);
  }, [task.id, onPress]);
  
  return (
    <TouchableOpacity onPress={handlePress}>
      <Text>{task.title}</Text>
    </TouchableOpacity>
  );
};

export default React.memo(TaskItem);
```

### æ ·å¼è§„èŒƒ

```typescript
// ï¿½?ä½¿ç”¨ StyleSheet.create
const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: COLORS.background,
  },
  title: {
    fontSize: SIZES.large,
    fontWeight: 'bold',
    color: COLORS.text,
  },
});

// ï¿½?é¿å…å†…è”æ ·å¼
<View style={{ flex: 1, backgroundColor: '#fff' }}>
```

### å‘½åè§„èŒƒ

```typescript
// ç»„ä»¶: PascalCase
TaskItem, DateSelector, BottomSheet

// å‡½æ•°: camelCase
loadTasks, handlePress, formatDate

// å¸¸é‡: UPPER_SNAKE_CASE
COLORS, SIZES, API_URL

// ç±»å‹/æ¥å£: PascalCase
Task, TaskState, TaskAction

// æ–‡ä»¶: ä¸å¯¼å‡ºå†…å®¹ä¸€ï¿½?
TaskItem.tsx, dateUtils.ts, constants.ts
```

### Git æäº¤è§„èŒƒ

```bash
# æ ¼å¼: <type>(<scope>): <subject>

# ç±»å‹
feat: æ–°åŠŸï¿½?
fix: ä¿®å¤ bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·ç›¸å…³

# ç¤ºä¾‹
feat(task): æ·»åŠ ä»»åŠ¡æ‹–æ‹½æ’åºåŠŸèƒ½
fix(reflection): ä¿®å¤å¡ç‰‡ç¼©æ”¾åŠ¨ç”»å¡é¡¿
docs(readme): æ›´æ–°å®‰è£…è¯´æ˜
```

---

## æ„å»ºå’Œéƒ¨ï¿½?

### å¼€å‘æ„ï¿½?

```cmd
# å¯åŠ¨ Metro bundler
npm start

# è¿è¡Œ Android (Debug)
npm run android

# æ¸…ç†ç¼“å­˜
npm start -- --reset-cache
```

### ç”Ÿäº§æ„å»º

#### 1. é…ç½®ç­¾å

ç”Ÿæˆ keystore:
```cmd
cd android
generate-keystore.bat
```

é…ç½®ç¯å¢ƒå˜é‡:
```cmd
set KEYSTORE_PASSWORD=your_password
set KEY_ALIAS=detter-key
set KEY_PASSWORD=your_password
```

#### 2. æ„å»º APK

```cmd
# æ–¹å¼ 1: ä½¿ç”¨è„šæœ¬
cd android
build-release.bat

# æ–¹å¼ 2: æ‰‹åŠ¨æ„å»º
cd android
gradlew assembleRelease
```

è¾“å‡ºä½ç½®: `android/app/build/outputs/apk/release/app-release.apk`

#### 3. æ„å»º AAB (Google Play)

```cmd
cd android
gradlew bundleRelease
```

è¾“å‡ºä½ç½®: `android/app/build/outputs/bundle/release/app-release.aab`

### APK ä¼˜åŒ–

å‚ï¿½?[APK_OPTIMIZATION.md](../android/APK_OPTIMIZATION.md):

1. **å¯ç”¨ ProGuard**
```gradle
buildTypes {
    release {
        minifyEnabled true
        shrinkResources true
        proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
    }
}
```

2. **å¯ç”¨ Hermes**
```gradle
project.ext.react = [
    enableHermes: true
]
```

3. **åˆ†ç¦» ABI**
```gradle
splits {
    abi {
        enable true
        reset()
        include "armeabi-v7a", "arm64-v8a", "x86", "x86_64"
        universalApk false
    }
}
```

### å‘å¸ƒæ£€æŸ¥æ¸…ï¿½?

å‚ï¿½?[RELEASE_CHECKLIST.md](../android/RELEASE_CHECKLIST.md):

- [ ] æ›´æ–°ç‰ˆæœ¬ï¿½?(versionCode, versionName)
- [ ] æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸï¿½?
- [ ] æ£€æŸ¥æ€§èƒ½æŒ‡æ ‡
- [ ] æ›´æ–° CHANGELOG
- [ ] ç”Ÿæˆç­¾å APK/AAB
- [ ] æµ‹è¯• Release ç‰ˆæœ¬
- [ ] å‡†å¤‡åº”ç”¨å•†åº—èµ„æº

---

## æµ‹è¯•æŒ‡å—

### æµ‹è¯•ç»“æ„

```
__tests__/
â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
ï¿½?  â”œâ”€â”€ services/
ï¿½?  â”œâ”€â”€ utils/
ï¿½?  â””â”€â”€ contexts/
â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
ï¿½?  â”œâ”€â”€ TaskCreationFlow.test.tsx
ï¿½?  â”œâ”€â”€ TaskCompletionFlow.test.tsx
ï¿½?  â””â”€â”€ DataImportExportFlow.test.tsx
â””â”€â”€ performance/             # æ€§èƒ½æµ‹è¯•
    â”œâ”€â”€ StartupPerformance.test.tsx
    â”œâ”€â”€ ListPerformance.test.tsx
    â””â”€â”€ AnimationPerformance.test.tsx
```

### è¿è¡Œæµ‹è¯•

```cmd
# è¿è¡Œæ‰€æœ‰æµ‹ï¿½?
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
npm test -- TaskService.test.ts

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥ï¿½?
npm test -- --coverage

# ç›‘å¬æ¨¡å¼
npm test -- --watch
```

### æµ‹è¯•ç¤ºä¾‹

**å•å…ƒæµ‹è¯•**:
```typescript
describe('TaskService', () => {
  it('should create a new task', async () => {
    const taskData = {
      title: 'æµ‹è¯•ä»»åŠ¡',
      priority: 'important',
      dueDate: new Date(),
      // ...
    };
    
    const task = await TaskService.createTask(taskData);
    
    expect(task.id).toBeDefined();
    expect(task.title).toBe('æµ‹è¯•ä»»åŠ¡');
  });
});
```

**ç»„ä»¶æµ‹è¯•**:
```typescript
describe('TaskItem', () => {
  it('should render task title', () => {
    const { getByText } = render(
      <TaskItem task={mockTask} onPress={jest.fn()} />
    );
    
    expect(getByText('æµ‹è¯•ä»»åŠ¡')).toBeTruthy();
  });
});
```

### æµ‹è¯•è¦†ç›–ç‡ç›®ï¿½?

- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘: 90%+
- UI ç»„ä»¶: 70%+
- å·¥å…·å‡½æ•°: 95%+

---

## æ€§èƒ½ä¼˜åŒ–

### 1. æ¸²æŸ“ä¼˜åŒ–

```typescript
// ä½¿ç”¨ React.memo
const TaskItem = React.memo(({ task, onPress }) => {
  // ...
}, (prevProps, nextProps) => {
  return prevProps.task.id === nextProps.task.id &&
         prevProps.task.updatedAt === nextProps.task.updatedAt;
});

// ä½¿ç”¨ useCallback
const handlePress = useCallback(() => {
  onPress(task.id);
}, [task.id, onPress]);

// ä½¿ç”¨ useMemo
const sortedTasks = useMemo(() => {
  return tasks.sort((a, b) => a.order - b.order);
}, [tasks]);
```

### 2. åˆ—è¡¨ä¼˜åŒ–

```typescript
<FlatList
  data={tasks}
  renderItem={renderItem}
  keyExtractor={item => item.id}
  // æ€§èƒ½ä¼˜åŒ–é…ç½®
  windowSize={10}
  maxToRenderPerBatch={10}
  updateCellsBatchingPeriod={50}
  removeClippedSubviews={true}
  initialNumToRender={10}
/>
```

### 3. åŠ¨ç”»ä¼˜åŒ–

```typescript
// ä½¿ç”¨ react-native-reanimated
const animatedStyle = useAnimatedStyle(() => {
  return {
    transform: [
      { scale: withSpring(pressed.value ? 0.95 : 1) }
    ],
  };
});
```

### 4. æ•°æ®åº“ä¼˜ï¿½?

```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_tasks_due_date ON tasks(due_date);
CREATE INDEX idx_tasks_completed ON tasks(completed);

-- ä½¿ç”¨äº‹åŠ¡
BEGIN TRANSACTION;
-- æ‰¹é‡æ“ä½œ
COMMIT;
```

---

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. Metro bundler å¯åŠ¨å¤±è´¥

```cmd
# æ¸…ç†ç¼“å­˜
npm start -- --reset-cache

# åˆ é™¤ä¸´æ—¶æ–‡ä»¶
rmdir /s /q %TEMP%\metro-*
rmdir /s /q %TEMP%\haste-map-*
```

#### 2. Android æ„å»ºå¤±è´¥

```cmd
# æ¸…ç†æ„å»º
cd android
gradlew clean

# åˆ é™¤ build ç›®å½•
rmdir /s /q app\build

# é‡æ–°æ„å»º
gradlew assembleDebug
```

#### 3. ä¾èµ–å®‰è£…é—®é¢˜

```cmd
# æ¸…ç†å¹¶é‡æ–°å®‰ï¿½?
rmdir /s /q node_modules
del package-lock.json
npm install
```

#### 4. æ•°æ®åº“é”™ï¿½?

```typescript
// æ£€æŸ¥æ•°æ®åº“åˆå§‹ï¿½?
await DatabaseService.init();

// æŸ¥çœ‹æ•°æ®åº“æ–‡ï¿½?
// Android: /data/data/com.detterapp/databases/detter.db
```

#### 5. æ€§èƒ½é—®é¢˜

```typescript
// ä½¿ç”¨ Performance Monitor
import { PerformanceObserver } from 'react-native';

// æ£€æŸ¥æ¸²æŸ“æ€§èƒ½
console.log('Render time:', performance.now());
```

### è°ƒè¯•å·¥å…·

**React Native Debugger**:
```cmd
# å¯åŠ¨è°ƒè¯•ï¿½?
npm start

# åœ¨æ¨¡æ‹Ÿå™¨ä¸­æŒ‰ Ctrl+M (Windows) ï¿½?Cmd+D (Mac)
# é€‰æ‹© "Debug"
```

**Flipper**:
- ç½‘ç»œè¯·æ±‚ç›‘æ§
- æ•°æ®åº“æŸ¥ï¿½?
- å¸ƒå±€æ£€ï¿½?
- æ€§èƒ½åˆ†æ

**Chrome DevTools**:
- Console æ—¥å¿—
- Network ç›‘æ§
- Source è°ƒè¯•

---

## è´¡çŒ®æŒ‡å—

### å¼€å‘æµï¿½?

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

### Code Review æ£€æŸ¥é¡¹

- [ ] ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
- [ ] æ·»åŠ äº†å¿…è¦çš„æµ‹è¯•
- [ ] æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] æ›´æ–°äº†ç›¸å…³æ–‡ï¿½?
- [ ] æ²¡æœ‰å¼•å…¥æ–°çš„è­¦å‘Š
- [ ] æ€§èƒ½æ²¡æœ‰æ˜æ˜¾ä¸‹é™

---

## ç›¸å…³æ–‡æ¡£

- [ç”¨æˆ·ä½¿ç”¨æŒ‡å—](USER_GUIDE.md)
- [å·²çŸ¥é—®é¢˜å’Œé™åˆ¶](KNOWN_ISSUES.md)
- [é¡¹ç›®ç»“æ„è¯´æ˜](PROJECT_STRUCTURE.md)
- [å¼€å‘ç¯å¢ƒé…ç½®](SETUP.md)
- [Android æ„å»ºéƒ¨ç½²](../android/BUILD_AND_DEPLOY.md)
- [æµ‹è¯•æŒ‡å—](TESTING_GUIDE.md)

---

## è”ç³»æ–¹å¼

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/yourusername/detter
- **é—®é¢˜åé¦ˆ**: https://github.com/yourusername/detter/issues
- **é‚®ä»¶**: dev@detter.app

---

**æœ€åæ›´ï¿½?*: 2025  
**ç‰ˆæœ¬**: v1.0.0  
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
